/*! For license information please see 973.js.LICENSE.txt */
"use strict";(self.webpackChunkhttp_step_extension=self.webpackChunkhttp_step_extension||[]).push([[973],{33973:(e,t,n)=>{n.r(t);var r=n(54896),s=n(82672),a=n(85893);const o=({parameters:e,handleChange:t})=>{const n=[];return e.forEach(((e,s,o)=>{n.push((0,a.jsx)(r.FormGroup,{label:s,fieldId:"id"+s,children:(0,a.jsx)(r.TextInput,{value:e,label:s,id:"idTextInput-"+s,name:"nameTextInput"+s,onChange:e=>{t(s,e)}})},"key"+s+o))})),n.length>0&&(0,a.jsx)(r.FormGroup,{label:"Parameters",fieldId:"simple-form-note-01",children:n})},i=e=>{const[t]=e.endpoint.operations.keys(),[n,i]=(0,s.useState)(t),l=(0,s.useRef)(new Map),[p,c]=(0,s.useState)(""),u=x(m(n)),[d]=l.current?.keys(),[h]=u.keys();function m(t){return e.endpoint.operations.get(t)}function x(e){const t=new Map;return e?.parameters?.forEach((e=>{t.set(e.name,"")})),t}function j(e){const t=x(m(e));l.current=new Map(t),i(e)}0!==l.current.size&&h===d||(l.current=u);const f=[];e.endpoint.operations.forEach(((e,t)=>{f.push((0,a.jsx)(r.FormSelectOption,{label:t,value:t},t))}));const b=new Array;return m(n)?.produces.forEach((e=>{b.push((0,a.jsx)(r.FormSelectOption,{label:e,value:e},e))})),(0,s.useEffect)((()=>{m(t)?.produces&&e.setContentType(m(t)?.produces[0]),j(t)}),[e.endpoint]),(0,a.jsxs)("div",{children:[!e.isSource&&(0,a.jsx)(r.FormGroup,{label:"Operation",children:(0,a.jsx)(r.FormSelect,{"aria-label":"OperationSelect",onChange:j,value:n,children:f})}),(0,a.jsx)(r.FormGroup,{label:"Produces",children:(0,a.jsx)(r.FormSelect,{"aria-label":"ContentTypeSelect",onChange:t=>{e.setContentType(t),c(t)},value:p,children:b})}),(0,a.jsx)(o,{parameters:l.current,handleChange:(t,r)=>{l.current.set(t,r);let s=e.endpoint.name,a="";l.current.forEach(((e,t)=>{if(e){const r=function(e){let t;return m(n)?.parameters?.forEach((n=>{n.name.toString()===e&&(t=n)})),t}(t);"path"===r.in?s=s.replace(`{${t}}`,e):"query"===r.in&&(a+=`&${t}=${e}`)}})),a.length>0&&(a="?"+a.substr(1)),e.setUrl(s+a)}}),(0,a.jsx)(r.FormGroup,{label:"Info",children:(0,a.jsxs)(r.Grid,{children:[(0,a.jsx)(r.GridItem,{span:6,children:"Summary"}),(0,a.jsx)(r.GridItem,{span:6,children:(0,a.jsx)("div",{children:m(n)?.summary})}),m(n)?.description&&(0,a.jsxs)("div",{children:[(0,a.jsx)(r.GridItem,{span:6,children:"Description"}),(0,a.jsx)(r.GridItem,{span:6,children:(0,a.jsx)("div",{children:m(n)?.description})})]}),(0,a.jsx)(r.GridItem,{span:6,children:"Tags"}),(0,a.jsx)(r.GridItem,{span:6,children:(0,a.jsx)(r.Label,{children:m(n)?.tags})})]})})]})},l=new Map([["ms",1],["s",1e3],["min",6e4],["hour",36e5],["day",864e5]]),p=e=>{const[t,n]=(0,s.useState)(e.initTimeUnit),[o,i]=(0,s.useState)(e.initPeriodInputValue);return(0,a.jsx)(r.FormGroup,{label:"Period",children:(0,a.jsxs)(r.Grid,{children:[(0,a.jsx)(r.GridItem,{span:4,children:(0,a.jsx)(r.TextInput,{value:o,onChange:i,type:"number","aria-label":"period"})}),(0,a.jsx)(r.GridItem,{span:8,children:(0,a.jsxs)(r.FormSelect,{id:"period-01",name:"simple-form-number",value:t,onChange:function(t){const r=l.get(t);n(t),r&&e.setTimePeriod(o*r)},children:[(0,a.jsx)(r.FormSelectOption,{value:"ms",label:"Miliseconds",isDisabled:!1},"ms"),(0,a.jsx)(r.FormSelectOption,{value:"s",label:"Seconds",isDisabled:!1},"s"),(0,a.jsx)(r.FormSelectOption,{value:"min",label:"Minutes",isDisabled:!1},"min"),(0,a.jsx)(r.FormSelectOption,{value:"hour",label:"Hours",isDisabled:!1},"hour"),(0,a.jsx)(r.FormSelectOption,{value:"day",label:"Days",isDisabled:!1},"day")]})})]})})};var c=n(70578),u=n.n(c),d=n(25108);const h=e=>{let t=e.stepParams?.period,n="s";l.forEach(((r,s)=>{const a=e.stepParams?.period||1;a/r>=1&&a%r==0&&(t=a/r,n=s)}));const[o,c]=(0,s.useState)(""),h=(0,s.useRef)([]),[m,x]=(0,s.useState)({name:"",pathItem:{},operations:new Map}),[j,f]=(0,s.useState)(!1),[b,y]=(0,s.useState)(""),[S,v]=(0,s.useState)(""),[I,T]=(0,s.useState)({url:e.stepParams?.url||"",period:e.stepParams?.period||1,contentType:e.stepParams?.contentType||""}),[C,g]=(0,s.useState)(""),[F,G]=(0,s.useState)("https://api.chucknorris.io/documentation"),O=async e=>{h.current=await async function(e,t){let n=new(u());const r=[];let s;try{s=await n.validate(e,{dereference:{circular:"ignore"}}),Object.entries(n.api.paths).forEach((e=>{const n=new Map;let s=!1;Object.entries(e[1]).forEach((e=>{t?("GET"===e[0].toUpperCase()&&(s=!0),n.set(e[0],e[1])):n.set(e[0],e[1])})),t?s&&r.push({name:e[0],pathItem:e[1],operations:n}):r.push({name:e[0],pathItem:e[1],operations:n})}))}catch(e){d.error("error "+e)}return r}(e,P()),x(h.current[0])};function P(){const t=e.step?.name.toString();return t?.includes("source")}(0,s.useEffect)((()=>{let e="";j&&""!==o&&(e=JSON.parse(o),O(e).catch(d.error))}),[o,j]);const E=[];h.current.forEach(((e,t)=>{E.push((0,a.jsx)(r.FormSelectOption,{value:t,label:e.name,isDisabled:!1},e.name))}));const _=(e,t)=>{y(e);const n=I;void 0!==t?(g(t),n.url=t+e):n.url=C+e,T(n)};function k(e,t,n){const r={period:n>0?n:I.period,url:""!==e?e:I.url,contentType:""!==t?t:I.contentType};T(r)}return(0,a.jsxs)(r.Form,{children:[(0,a.jsxs)(r.FormGroup,{label:"OpenApi",fieldId:"open-api-file-upload",children:[(0,a.jsx)(r.Checkbox,{id:"inputType",label:"Upload spec",isChecked:j,onChange:f}),j&&(0,a.jsx)(r.FileUpload,{id:"simple-file",value:o,filenamePlaceholder:"Drag and drop a open API spec or upload one",onFileInputChange:(e,t)=>{t.text().then((e=>{c(e)}))},onClearClick:e=>{c("")},browseButtonText:"Upload"}),!j&&(0,a.jsxs)(r.InputGroup,{children:[(0,a.jsx)(r.TextInput,{id:"specUrlInput","aria-label":"Api spec url",value:F,onChange:G}),(0,a.jsx)(r.Button,{onClick:()=>{let e=new URL(F);O(F).catch(d.error),_("",e.origin)},children:"Load"})]})]}),(0,a.jsx)(r.FormGroup,{label:"Base Path",children:(0,a.jsxs)(r.Grid,{children:[(0,a.jsx)(r.GridItem,{span:6,children:(0,a.jsx)(r.TextInput,{id:"basePathInput","aria-label":"Base path",value:C,onChange:e=>{_(b,e)}})}),(0,a.jsx)(r.GridItem,{span:6,children:(0,a.jsx)(r.FormSelect,{minLength:500,type:"text",id:"simple-form-note-01",name:"simple-form-number",value:S,onChange:function(e){const t=Number(e);v(e),x(h.current[t]),_(h.current[t]?.name)},children:E})})]})}),""!==m?.name&&(0,a.jsx)(i,{endpoint:m,isSource:P(),setUrl:_,setContentType:e=>{k("",e,0)}}),P()&&(0,a.jsx)(p,{initTimeUnit:n,initPeriodInputValue:t,setTimePeriod:e=>{k("","",e)}}),(0,a.jsx)(r.FormGroup,{label:"URL",children:(0,a.jsx)(r.TextInput,{onChange:e=>k(e,"",0),value:I.url,"aria-label":"url-read-only"})}),(0,a.jsx)(r.FormGroup,{label:"Content Type",children:(0,a.jsx)(r.TextInput,{onChange:e=>k("",e,0),value:I.contentType,"aria-label":"url-read-only"})}),(0,a.jsx)(r.ActionGroup,{children:(0,a.jsx)(r.Button,{variant:"primary",onClick:function(){e.notifyKaoto("Http step updated"),P()?e.updateStepParams(I):e.updateStepParams({url:I.url,contentType:I.contentType})},children:"Apply"})})]})};n(1298),n(36699),n(73175),n(46530),n(99574),n(9750);const m=()=>(0,a.jsxs)("div",{className:"App",children:[(0,a.jsx)("header",{className:"App-header",children:(0,a.jsx)("p",{})}),(0,a.jsx)(h,{})]});var x=n(20745);const j=document.getElementById("root");(0,x.s)(j).render((0,a.jsx)(m,{}))},20745:(e,t,n)=>{var r=n(31051);t.s=r.createRoot,r.hydrateRoot},75251:(e,t,n)=>{var r=n(82672),s=Symbol.for("react.element"),a=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,n){var r,l={},p=null,c=null;for(r in void 0!==n&&(p=""+n),void 0!==t.key&&(p=""+t.key),void 0!==t.ref&&(c=t.ref),t)a.call(t,r)&&!i.hasOwnProperty(r)&&(l[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===l[r]&&(l[r]=t[r]);return{$$typeof:s,type:e,key:p,ref:c,props:l,_owner:o.current}}t.jsx=l,t.jsxs=l},85893:(e,t,n)=>{e.exports=n(75251)}}]);
//# sourceMappingURL=973.js.map