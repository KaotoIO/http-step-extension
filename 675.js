/*! For license information please see 675.js.LICENSE.txt */
"use strict";(self.webpackChunkhttp_step_extension=self.webpackChunkhttp_step_extension||[]).push([[675],{20436:(e,t,n)=>{n.d(t,{r:()=>i});var r=n(54896),a=n(82672),s=n(85893);const o=({parameters:e,handleChange:t})=>{const n=[];return e.forEach(((e,a,o)=>{n.push((0,s.jsx)(r.FormGroup,{label:a,fieldId:"id"+a,children:(0,s.jsx)(r.TextInput,{value:e,label:a,id:"idTextInput-"+a,name:"nameTextInput"+a,onChange:e=>{t(a,e)}})},"key"+a+o))})),n.length>0&&(0,s.jsx)(r.FormGroup,{label:"Parameters",fieldId:"simple-form-note-01",children:n})},i=e=>{const[t]=e.endpoint.operations.keys(),[n,i]=(0,a.useState)(t),l=(0,a.useRef)(new Map),[p,c]=(0,a.useState)(""),u=x(m(n)),[d]=l.current?.keys(),[h]=u.keys();function m(t){return e.endpoint.operations.get(t)}function x(e){const t=new Map;return e?.parameters?.forEach((e=>{t.set(e.name,"")})),t}function j(e){const t=x(m(e));l.current=new Map(t),i(e)}0!==l.current.size&&h===d||(l.current=u);const f=[];e.endpoint.operations.forEach(((e,t)=>{f.push((0,s.jsx)(r.FormSelectOption,{label:t,value:t},t))}));const b=new Array;return m(n)?.produces.forEach((e=>{b.push((0,s.jsx)(r.FormSelectOption,{label:e,value:e},e))})),(0,a.useEffect)((()=>{m(t)?.produces&&e.setContentType(m(t)?.produces[0]),j(t)}),[e.endpoint]),(0,s.jsxs)("div",{children:[!e.isSource&&(0,s.jsx)(r.FormGroup,{label:"Operation",children:(0,s.jsx)(r.FormSelect,{"aria-label":"OperationSelect",onChange:j,value:n,children:f})}),(0,s.jsx)(r.FormGroup,{label:"Produces",children:(0,s.jsx)(r.FormSelect,{"aria-label":"ContentTypeSelect",onChange:t=>{e.setContentType(t),c(t)},value:p,children:b})}),(0,s.jsx)(o,{parameters:l.current,handleChange:(t,r)=>{l.current.set(t,r);let a=e.endpoint.name,s="";l.current.forEach(((e,t)=>{if(e){const r=function(e){let t;return m(n)?.parameters?.forEach((n=>{n.name.toString()===e&&(t=n)})),t}(t);"path"===r.in?a=a.replace(`{${t}}`,e):"query"===r.in&&(s+=`&${t}=${e}`)}})),s.length>0&&(s="?"+s.substr(1)),e.setUrl(a+s)}}),(0,s.jsx)(r.FormGroup,{label:"Info",children:(0,s.jsxs)(r.Grid,{children:[(0,s.jsx)(r.GridItem,{span:6,children:"Summary"}),(0,s.jsx)(r.GridItem,{span:6,children:(0,s.jsx)("div",{children:m(n)?.summary})}),m(n)?.description&&(0,s.jsxs)("div",{children:[(0,s.jsx)(r.GridItem,{span:6,children:"Description"}),(0,s.jsx)(r.GridItem,{span:6,children:(0,s.jsx)("div",{children:m(n)?.description})})]}),(0,s.jsx)(r.GridItem,{span:6,children:"Tags"}),(0,s.jsx)(r.GridItem,{span:6,children:(0,s.jsx)(r.Label,{children:m(n)?.tags})})]})})]})}},18675:(e,t,n)=>{n.r(t),n.d(t,{HttpStep:()=>u,default:()=>d});var r=n(20436),a=n(73653),s=n(70578),o=n.n(s),i=n(54896),l=n(82672),p=n(85893),c=n(25108);const u=e=>{let t=e.stepParams?.period,n="s";a.F.forEach(((r,a)=>{const s=e.stepParams?.period||1;s/r>=1&&s%r==0&&(t=s/r,n=a)}));const[s,u]=(0,l.useState)(""),d=(0,l.useRef)([]),[h,m]=(0,l.useState)({name:"",pathItem:{},operations:new Map}),[x,j]=(0,l.useState)(!1),[f,b]=(0,l.useState)(""),[y,S]=(0,l.useState)(""),[v,I]=(0,l.useState)({url:e.stepParams?.url||"",period:e.stepParams?.period||1,contentType:e.stepParams?.contentType||""}),[T,C]=(0,l.useState)(""),[F,g]=(0,l.useState)("https://api.chucknorris.io/documentation"),G=async e=>{d.current=await async function(e,t){let n=new(o());const r=[];let a;try{a=await n.validate(e,{dereference:{circular:"ignore"}}),Object.entries(n.api.paths).forEach((e=>{const n=new Map;let a=!1;Object.entries(e[1]).forEach((e=>{t?("GET"===e[0].toUpperCase()&&(a=!0),n.set(e[0],e[1])):n.set(e[0],e[1])})),t?a&&r.push({name:e[0],pathItem:e[1],operations:n}):r.push({name:e[0],pathItem:e[1],operations:n})}))}catch(e){c.error("error "+e)}return r}(e,O()),m(d.current[0])};function O(){const t=e.step?.name.toString();return t?.includes("source")}(0,l.useEffect)((()=>{let e="";x&&""!==s&&(e=JSON.parse(s),G(e).catch(c.error))}),[s,x]);const P=[];d.current.forEach(((e,t)=>{P.push((0,p.jsx)(i.FormSelectOption,{value:t,label:e.name,isDisabled:!1},e.name))}));const _=(e,t)=>{b(e);const n=v;void 0!==t?(C(t),n.url=t+e):n.url=T+e,I(n)};function E(e,t,n){const r={period:n>0?n:v.period,url:""!==e?e:v.url,contentType:""!==t?t:v.contentType};I(r)}return(0,p.jsxs)(i.Form,{children:[(0,p.jsxs)(i.FormGroup,{label:"OpenApi",fieldId:"open-api-file-upload",children:[(0,p.jsx)(i.Checkbox,{id:"inputType",label:"Upload spec",isChecked:x,onChange:j}),x&&(0,p.jsx)(i.FileUpload,{id:"simple-file",value:s,filenamePlaceholder:"Drag and drop a open API spec or upload one",onFileInputChange:(e,t)=>{t.text().then((e=>{u(e)}))},onClearClick:e=>{u("")},browseButtonText:"Upload"}),!x&&(0,p.jsxs)(i.InputGroup,{children:[(0,p.jsx)(i.TextInput,{id:"specUrlInput","aria-label":"Api spec url",value:F,onChange:g}),(0,p.jsx)(i.Button,{onClick:()=>{let e=new URL(F);G(F).catch(c.error),_("",e.origin)},children:"Load"})]})]}),(0,p.jsx)(i.FormGroup,{label:"Base Path",children:(0,p.jsxs)(i.Grid,{children:[(0,p.jsx)(i.GridItem,{span:6,children:(0,p.jsx)(i.TextInput,{id:"basePathInput","aria-label":"Base path",value:T,onChange:e=>{_(f,e)}})}),(0,p.jsx)(i.GridItem,{span:6,children:(0,p.jsx)(i.FormSelect,{minLength:500,type:"text",id:"simple-form-note-01",name:"simple-form-number",value:y,onChange:function(e){const t=Number(e);S(e),m(d.current[t]),_(d.current[t]?.name)},children:P})})]})}),""!==h?.name&&(0,p.jsx)(r.r,{endpoint:h,isSource:O(),setUrl:_,setContentType:e=>{E("",e,0)}}),O()&&(0,p.jsx)(a.u,{initTimeUnit:n,initPeriodInputValue:t,setTimePeriod:e=>{E("","",e)}}),(0,p.jsx)(i.FormGroup,{label:"URL",children:(0,p.jsx)(i.TextInput,{onChange:e=>E(e,"",0),value:v.url,"aria-label":"url-read-only"})}),(0,p.jsx)(i.FormGroup,{label:"Content Type",children:(0,p.jsx)(i.TextInput,{onChange:e=>E("",e,0),value:v.contentType,"aria-label":"url-read-only"})}),(0,p.jsx)(i.ActionGroup,{children:(0,p.jsx)(i.Button,{variant:"primary",onClick:function(){e.notifyKaoto("Http step updated"),O()?e.updateStepParams(v):e.updateStepParams({url:v.url,contentType:v.contentType})},children:"Apply"})})]})},d=u},73653:(e,t,n)=>{n.d(t,{F:()=>o,u:()=>i});var r=n(54896),a=n(82672),s=n(85893);const o=new Map([["ms",1],["s",1e3],["min",6e4],["hour",36e5],["day",864e5]]),i=e=>{const[t,n]=(0,a.useState)(e.initTimeUnit),[i,l]=(0,a.useState)(e.initPeriodInputValue);return(0,s.jsx)(r.FormGroup,{label:"Period",children:(0,s.jsxs)(r.Grid,{children:[(0,s.jsx)(r.GridItem,{span:4,children:(0,s.jsx)(r.TextInput,{value:i,onChange:l,type:"number","aria-label":"period"})}),(0,s.jsx)(r.GridItem,{span:8,children:(0,s.jsxs)(r.FormSelect,{id:"period-01",name:"simple-form-number",value:t,onChange:function(t){const r=o.get(t);n(t),r&&e.setTimePeriod(i*r)},children:[(0,s.jsx)(r.FormSelectOption,{value:"ms",label:"Miliseconds",isDisabled:!1},"ms"),(0,s.jsx)(r.FormSelectOption,{value:"s",label:"Seconds",isDisabled:!1},"s"),(0,s.jsx)(r.FormSelectOption,{value:"min",label:"Minutes",isDisabled:!1},"min"),(0,s.jsx)(r.FormSelectOption,{value:"hour",label:"Hours",isDisabled:!1},"hour"),(0,s.jsx)(r.FormSelectOption,{value:"day",label:"Days",isDisabled:!1},"day")]})})]})})}},75251:(e,t,n)=>{var r=n(82672),a=Symbol.for("react.element"),s=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,n){var r,l={},p=null,c=null;for(r in void 0!==n&&(p=""+n),void 0!==t.key&&(p=""+t.key),void 0!==t.ref&&(c=t.ref),t)s.call(t,r)&&!i.hasOwnProperty(r)&&(l[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===l[r]&&(l[r]=t[r]);return{$$typeof:a,type:e,key:p,ref:c,props:l,_owner:o.current}}t.jsx=l,t.jsxs=l},85893:(e,t,n)=>{e.exports=n(75251)}}]);
//# sourceMappingURL=675.js.map